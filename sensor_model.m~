%% data
distance_data = xlsread('distance_data');
distance = distance_data(:,1);
area_percent = distance_data(:,2)*100;
figure
plot(distance, area_percent, 'o', 'Linewidth', 2)
xlabel('distance (inches)')
ylabel('percent area (%)')

%% nonlinear least squares data fitting

y = area_percent;
m = 28;
d = distance;

g       = @(x) sqrt(2).*(x(1)*exp(-x(2).*d) + x(3) - y);
dgda    = @(x) exp(-x(2).*d);
dgdb    = @(x) -x(2)*x(1).*exp(-x(2).*d);
dgdc    = ones(m,1);

J = @(x) sqrt(2)*[dgda(x), dgdb(x), dgdc];

a0 = 1;
b0 = .0001;
c0 = 1;

x_k = [a0; b0; c0];

for i = 1:1
    dgda(x_k);
    [dgda(x_k), dgdb(x_k), dgdc];
    A = J(x_k)'*J(x_k)
    x_k = x_k - (J(x_k)'*J(x_k) + )\J(x_k)'*g(x_k);
end

x_k

% figure(6)
% plot(t,y,'.')
% hold on
% T = @(x) x(1).*sin(2.*pi./x(5).*t + x(4)) + x(2).*t + x(3);
% plot(t,T(x_k),'LineWidth',2)
% xlabel('time (days)')
% ylabel('Temperature (degrees Farenheit)')
% title('Average Daily Temperature Model')
% legend('Temperature Data', 'Temperature Model')
